# Static Analysis
Accomplished without executing the malware.

## File Types
In some cases the file extension will not match the actual file type of the malware.
```sh
file malwaresample.ps1

malwaresample.ps1: PE32 executable (GUI) Intel 80386, for MS Wnidows
```
We can determine the following from that output:
- PE32 executable
- Graphical User Interface
- Compiled for Microsoft Windows 
- Intel 80386-base processesor
- Designed for 32-bit processors

## Strings
The `strings` command will list all the strings in the file. This will help provide context at a glance. In most cases this output will be quite large and you will want to redirect it to a file.
```sh
strings malwaresample.ps1

hello
world
Invoke-WebRequest
```

## Hashes
This can be used to identify the integrity of a file.  The commands are simple and follow the syntax `hash + sum` filename

| Hash | Description |
| ---- | ----------- |
| `md5sum` | MD5 check |
| `sha1sum` | sha1 check |
| `sha256sum` | sha256 check |

## Virus Total
Is a great tool to identify commom malicious files, urls, and addresses.


## PE Header
Contains the metadata about a Portable Executable file.

### Imports / Exports
Imports are commonly used to reduce redundancy in a code base. There is no need to re-write code when it is likely contained within the OS already.

Exports are generally associated with DLL files and allow functions to be exposed to other binaries.


### Sections
A PE file is divided into sections which have different purposes.

| Section | Description |
| `.text:` | CPU instructions executed |
| `.data:` | Global variables |
| `.rsrc:` | Resources such as images |

### PECheck Utility
This is example output from the command `pecheck wannacry`

```sh
pecheck wannacry 
PE check for 'wannacry':
Entropy: 7.995471 (Min=0.0, Max=8.0)
MD5     hash: 84c82835a5d21bbcf75a61706d8ab549
SHA-1   hash: 5ff465afaabcbf0150d1a3ab2c2e74f3a4426467
SHA-256 hash: ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa
SHA-512 hash: 90723a50c20ba3643d625595fd6be8dcf88d70ff7f4b4719a88f055d5b3149a4231018ea30d375171507a147e59f73478c0c27948590794554d031e7d54b7244
.text entropy: 6.404235 (Min=0.0, Max=8.0)
.rdata entropy: 6.663571 (Min=0.0, Max=8.0)
.data entropy: 4.455750 (Min=0.0, Max=8.0)
.rsrc entropy: 7.999868 (Min=0.0, Max=8.0)
Dump Info:
----------DOS_HEADER----------

[IMAGE_DOS_HEADER]
0x0        0x0   e_magic:                       0x5A4D    
0x2        0x2   e_cblp:                        0x90      
0x4        0x4   e_cp:                          0x3       
.
.
[IMAGE_IMPORT_DESCRIPTOR]
0xD5D0     0x0   OriginalFirstThunk:            0xD60C    
0xD5D0     0x0   Characteristics:               0xD60C    
0xD5D4     0x4   TimeDateStamp:                 0x0        [Thu Jan  1 00:00:00 1970 UTC]
0xD5D8     0x8   ForwarderChain:                0x0       
0xD5DC     0xC   Name:                          0xDC84    
0xD5E0     0x10  FirstThunk:                    0x8000    

ADVAPI32.dll.CreateServiceA Hint[100]
ADVAPI32.dll.OpenServiceA Hint[431]
ADVAPI32.dll.StartServiceA Hint[585]
ADVAPI32.dll.CloseServiceHandle Hint[62]
ADVAPI32.dll.CryptReleaseContext Hint[160]
ADVAPI32.dll.RegCreateKeyW Hint[467]
ADVAPI32.dll.RegSetValueExA Hint[516]
ADVAPI32.dll.RegQueryValueExA Hint[503]
ADVAPI32.dll.RegCloseKey Hint[459]
ADVAPI32.dll.OpenSCManagerA Hint[429]
```

