# John the Ripper
Cracking hashes using john the ripper.

## Basic Cracking Process 

### 1. Create a file
Add the target hash to a file (crack.txt)

### 2. Identify Hash
This may need to be done manually by comparing using the table below, the length of the hash, encoding, or online resources. 

| Prefix  | Algorithm |
| ------- | --------- |
| $1$ | md5crypt, Cisco & older Linux/Unix systems |
| $2$, $2a$, $2b$, $2x$, $2y$ | Bcrypt (web) |
| $6$ | sha512crypt, Linux default | 

john will try to identify the hash if you omit the `--format` switch, but it is confused easily.

### 3. Crack
In some cases you will have to identify the hash before you are able to crack it. [Crackstation.com](https://crackstation.net/)

Search for formats:
```sh
john --list=formats 
john --list=formats | grep -i "md5" 
```

If the hash does not contain any salts you can use the `raw` prefix

```sh
john --wordlist=/usr/shar/wordlists/rockyou.txt --format=bcrypt crack.txt
```

## Single Crack Mode
Single crack mode or word mangling allows you to generate single character variations of a word:

- Password1, Password2, Password3
- PAssword1, PASword1, PASSword1

The format will be slightly different as we will need to append a username (in this case Admin) to the hash for john to understand:

From:
1efee03cdcb96d90ad48ccc7b8666033

To:
Admin:1efee03cdcb96d90ad48ccc7b8666033

## Custom Lists
Custom rules are defined in `john.conf` and are typically under `/etc/john/john.conf`.

### 1. Define Rule Name
In the `john.conf` file add a new line containing:

`[List.Rules:MyRuleName]`

`Az` - Takes the word and appends it with the characters you define.
`A0` - Takes the word and *prepends* it with the characters you define.
`c` - Capitalizes the character in position.

To define what characters should be appended prepended or otherwise included we use the `[]` 

`[0-9]` - Include numbers 0-9
`[0]` - Will include only the number 0
`[A-z]` - Upper and lowercase
`[A-Z]` - Uppercase
`[a-s]` - Lowercase
`[a]` - Only a
`[!$%]` - Symbols

### 2. Building a Rule
We are going to exploit the human tendency to create passwords with:

- Starts with a capital letter
- Ends with special characters

```sh
[List.Rules:MyNewRule]
cAz"[0-9][!$@%]"
```

### 3. Calling the Rule
You would call this rule by using the `--rule` switch:

```sh
john --wordlist=rockyou.txt --rule=MyNewRule crack.txt
```

## Cracking Password Protected Zip Files
Using the john suite `zip2john` we can crack zip files using a password.

### 1. Convert the zip to hash format
The following commands can be used to hash and crack a zip file:

```sh
zip2john [options] [zip file] > [output]

zip2john myzip.zip > hashed.txt

john --wordlist=rockyou.txt hashed.txt
```

You will then need to unzip the file and give it the password:
```sh
unzip myzip.zip

cat myzip/flag.txt
```

## Cracking Password Protected RAR Archives
Using the same process as above we can crack RAR files:

Note: If you can't find the program you can use:

```sh
locate rar2john
```

```sh
rar2john [rar file] > [output file]

rar2john myrar.rar > crack.txt

john --wordlist=rockyou.txt crack.txt
```

To read the contents of a rar file you can use:

```sh
unrar x file.rar
```

## Cracking SSH Key Passwords
Similar to the other cracks:

```sh
locate ssh2john

ssh2john [ssh_key] > crack.txt

john --wordlist=rockyou.txt crack.txt
```

## Cracking GPG
Assume you have a private key and an encrypted message:

If the private key is not password protected:
```sh
gpg --import private.key
gpg --decrypt message.gpg
```

With password protection:
```sh
gpg2john private.key > crack.txt
john --format=gpg --wordlist=rockyou.txt crack.txt
```
