# RSA Cracking

Key variables:
| variable | description |
| -------- | ----------- |
| p,q | large prime numbers |
| n | product of p * q |
| n,e | public key |
| n,d | private key |
| m | message in plain text |
| c | cipher / encrypted text |

## Generating Public / Private Keys
1. Choose 2 random prime numbers (p, q)
2. Calculate `N=pxq`
3. Choose 2 integers `e` and `d` such that `e*d=1 mode Φ(N)`, where `Φ(N) = N-p-q+1`

## Encryption
The sender can encrypt by:
```sh
y=x^e%N
```

## Decrption
```sh
x=y^d%N
```

Note:
Restrictions are put on the choice end of `e` and `d`
```sh
y^d=x^ed=x^kΦ(N)+1=(x^Φ(N)^k*x=x
```

### Reading Values
You can see an output of the actual variables:

| Variable | Location |
| -------- | -------- |
| `p` | prime1 |
| `q` | prime2 |
| `N` | modulus |
| `e` | publicExponent |
| `d` | privateExponent |

```sh
openssl rsa -in private-key-bob.pem -text -noout
```

### Example
1. Bob chooses 2 prime numbers `p=157,q=199,N=31243`
2. With `Φ(N)=N-p-q+1=31243-157-199+1=30888`, Bob selects `e=163` and `d=379` where `e*d=163*379=61777` and `61777 % 30888 = 1`

Public Key: 31243,163
Private Key: 31243,379

3. Lets say the value to encrypt is `x=13` and then Alice would calculate and send `y=x^e%N=13^163%31243=16342`
4. Bob decrypts `x=y^d%N=16341^379%31243=13`
