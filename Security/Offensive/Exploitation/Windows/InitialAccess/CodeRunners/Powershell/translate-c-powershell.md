# Translate Windows APIs to Powershell
This is easily done using [P/Invoke](https://learn.microsoft.com/en-us/dotnet/standard/native-interop/pinvoke). Must be imported through the `using` directive keyword.

## Helpful Tools
- [https://github.com/microsoft/CsWin32](https://github.com/microsoft/CsWin32)
- [https://www.pinvoke.net](https://www.pinvoke.net)

## 1. Read Function Documentation:
Original Syntax for `MessageBox` from `User32.dll`
```sh
int MessageBox(
    HWND    hWnd,
    LPCTSTR lpText,
    LPCTSTR lpCaption,
    UINT    uType
);
```

## 2. Translated Signature:
Using any of the above tools, determine the translated signature for the function:
```pwsh
[DllImport("user32.dll", SetLastError = true, CharSet = CharSet.Auto)]
public static extern int MessageBox(int hWnd, String text, String caption, uint type);
```

Import the namespaces:
```pwsh
using System;
using System.Runtime.InteropServices;
```

Create a C# class (User32) which imports the signature with DllImport.
```pwsh
public class User32 {
    [DllImport("user32.dll",CharSet=CharSet.Auto)]
    public static extern int MessageBox(IntPtr hWnd, String text, String caption, int options);
}
```

## 3. Create heredoc string
Invoke from Powershell using the `Add-Type` keyword. This will force `.NET` to complie and create an object containing our code inside the `Add-Type` statement. 

```pwsh
$User32 = @"
using System;
using System.Runtime.InteropServices;

public class User32 {
    [DllImport("user32.dll", CharSet=CharSet.Auto)]
    public static extern int MessageBox(IntPtr hWnd, String text, String caption, int options);
}
"@

Add-Type $User32
```

## 4. Execute API
We will do this by instantiating the `User32.NET` object at the end of our code:
```pwsh
$User32 = @"
using System;
using System.Runtime.InteropServices;

public class User32 {
    [DllImport("user32.dll", CharSet=CharSet.Auto)]
    public static extern int MessageBox(IntPtr hWnd, String text, String caption, int options);
}
"@

Add-Type $User32

[User32]::MessageBox(0,"This is a test","MyBox",0)
```
