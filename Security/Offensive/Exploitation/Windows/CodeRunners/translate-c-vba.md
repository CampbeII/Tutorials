# Windows API calls
How to translate C to VBA macros.

## 1. Find the low level API documentation
This can be found in the microsoft document. For this example we will attempt to call [GetPhysicallyInstalledSystemMemory]('https://learn.microsoft.com/en-us/windows/win32/api/sysinfoapi/nf-sysinfoapi-getphysicallyinstalledsystemmemory')

## 2. Analyze Function
- The following function will take 1 parameter and return a boolean.
- The dll is Kernel32.dll

```
BOOL GetPhysicallyInstalledSystemMemory(
    [out] PULONGLONG TotalMemoryInKilobytes
);
```

## 3. Declare Function
- Since the variable types are similar, we can pass them by reference
- The function will return a BOOL, which we can cast as a long

Note: I could not use an alias in this line. Typically Windows API functions have 2 variations. 

1. ANSI (with an A suffix)
2. Unicode (with a W suffix)

GetPhysicallyInstalledSystemMemory cannot be called with either.
```
Private Declare PtrSafe Function GetPhysicallyInstalledSystemMemory Lib "kernel32" (ByRef mem As Long) As Long
```

## 4. Create the macro
We will declare a new function `GetSystemMemory` which will call our delared function. 
```
Sub GetSystemMemory()
    Dim TotalMemory As Long
    Dim Result As Long
    Result = GetPhysicallyInstalledSystemMemory(TotalMemory)
            
    MsgBox "Total Physical Memory:" & TotalMemory & " KB"
End Sub
```
