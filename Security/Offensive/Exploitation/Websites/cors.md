# Cross-Origin Resource Sharing
Enables the secure communication between different urls.

## Misconfigurations

### 1. Null Origin
A request made outside of the standard browser.
```
Origin: http://example.com
Access-Control-Allow-Origin: null
```

Can be circumvented by sending a request from a document or sandboxed `iframe`
```html
<iframe sandbox="allow-scripts allow-top-navigiation allow-forms" src='data: text/html, <script>//exploit</script></iframe>
```

### 2. Pattern Matching
Attempting to match a domain using a flawed regex or `starts_with` function.
```
Origin: http://example.com
Access-Control-Allow-Origin: http://example.com
```

Can be circumvented by crafting a specific URL using subdomains:
```
Origin: http://example.com.evil.com
```

### 3. Related Domains
In some cases an application may not advertise it is implementing CORS, but you may be able to trick it by sending a related domain.

```
Host: question.com
Cookie: <cookie>
Origin: example.com
```

```
Access-Control-Allow-Origin: example.com
```


### 4. Tunneling
Useful for breaching internal networks. 

Conditions:
1. Application uses `Access-Control-Allow-Origin: *`
2. Victim is on internal network
3. Victim clicks malicious link.
4. Script is executed in the context of the users browser
5. Credentials are accessed and passed to the malicious server

